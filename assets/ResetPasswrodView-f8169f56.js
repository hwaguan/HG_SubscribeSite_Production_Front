import{d as V,s as A,j as S,u as b,r as l,o as P,c as g,f as o,a as s,y,I as x,E as C,B as L,e as D,k as R,p as H,g as z,A as U,_ as $}from"./index-be54d010.js";const i=u=>(H("data-v-ae13485e"),u=u(),z(),u),F={class:"resetPasswordContainer"},K={key:0,class:"resetPasswordBody"},N=i(()=>s("div",{class:"resetPasswordTitle"},[s("h3",null,"會員密碼重置")],-1)),Z=i(()=>s("div",{class:"resetPasswordRules"},[s("ul",null,[s("li",null,"請輸入 6 ~ 12 位大小寫英數字密碼 (例:Ps1234)"),s("li",null,"同一帳號單月僅能進行三次密碼重置，請謹慎操作並牢記密碼")])],-1)),j={class:"resetPasswordCase"},q=i(()=>s("div",{class:"inputTitle"},"新密碼",-1)),G=i(()=>s("div",{class:"imputDot"},":",-1)),J={class:"inputContainer"},O=["type"],Q=["innerHTML"],W=i(()=>s("div",{class:"inputTitle"},"確認密碼",-1)),X=i(()=>s("div",{class:"imputDot"},":",-1)),Y={class:"inputContainer"},ss=["type"],es=["innerHTML"],ts={class:"buttonCase"},os=V({__name:"ResetPasswrodView",emits:["loadingSwitch","memberStatusChange"],setup(u,{emit:k}){const p=A(),B=S(),f=b(),{rkey:w}=B.params,v=new U,T=k,_=a=>{T("loadingSwitch",a)};let c=l(!1),M=l(!1),E=l(!1),m=l(!1),d=l(""),r=l(""),t=l({passowrd:"",confirmPassword:""});console.log(w),(async()=>{const a=p.hostPath+p.memberVerifyResetKeyPath;_(!0);const e=await v.callAPI(a,{resetKey:w});if(_(!1),console.log(e),e.result)m.value=!0;else{const n=e.code==666?"無效的重置驗證碼，無法進行重置":"系統發生錯誤，請稍候再試";R.fire({icon:"error",title:"密碼重置失敗",text:n,confirmButtonColor:"#3085d6",confirmButtonText:"碓定"}).then(ns=>{f.push("/")})}})();const h=()=>{const a=new RegExp(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{6,12}$/);a.test(t.value.passowrd)||(d.value="密碼格式不正確"),a.test(t.value.confirmPassword)||(r.value="確認密碼格式不正確"),t.value.passowrd!=""&&t.value.confirmPassword!=""&&(t.value.passowrd!=t.value.confirmPassword?(r.value="確認密碼與密碼不相符",c.value=!1):c.value=!0)},I=async()=>{if(c.value){const a=p.hostPath+p.memberResetPasswordPath;_(!0),console.log({logToken:w,newPassword:t.value.passowrd});const e=await v.callAPI(a,{logToken:w,newPassword:t.value.passowrd});console.log(e),_(!1),e.result&&R.fire({icon:"success",title:"密碼重置成功",text:"請您牢記新的密碼並重新登入",confirmButtonColor:"#3085d6",confirmButtonText:"碓定"}).then(n=>{f.push("/")})}};return(a,e)=>(P(),g("div",F,[o(m)?(P(),g("div",K,[N,Z,s("div",j,[q,G,s("div",J,[y(s("input",{type:o(M)?"text":"password",maxlength:"12",placeholder:"請輸入新密碼","onUpdate:modelValue":e[0]||(e[0]=n=>o(t).passowrd=n),onBlur:h,onFocus:e[1]||(e[1]=n=>C(d)?d.value="":d="")},null,40,O),[[x,o(t).passowrd]]),s("div",{class:"confirmError",innerHTML:o(d)},null,8,Q)]),W,X,s("div",Y,[y(s("input",{type:o(E)?"text":"password",maxlength:"12",placeholder:"請再次輸入新密碼","onUpdate:modelValue":e[2]||(e[2]=n=>o(t).confirmPassword=n),onBlur:h,onFocus:e[3]||(e[3]=n=>C(r)?r.value="":r="")},null,40,ss),[[x,o(t).confirmPassword]]),s("div",{class:"confirmError",innerHTML:o(r)},null,8,es)])]),s("div",ts,[s("div",{class:L(["triggerChangeBtn",{btnLocked:!o(c),btnUnlock:o(c)}]),onClick:I},"確認重置",2)])])):D("",!0)]))}});const rs=$(os,[["__scopeId","data-v-ae13485e"]]);export{rs as default};
